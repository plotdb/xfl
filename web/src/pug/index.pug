doctype html
include @/bootstrap.ldui/dist/index.pug
//- var fontlist = ["851手書き雑フォント","中楷體","瀨戶字体","花園明朝","中仿宋體","刻石錄明體","站酷快乐体2016修订版","衡山毛筆","中圓體","刻石錄鋼筆鶴體","站酷高端黑体修订2015","中明體","刻石錄顏體","粗黑體","王漢宗中魏碑簡體","王漢宗仿宋體","王漢宗粗鋼體","王漢宗粗黑體實陰","王漢宗標楷體空心","王漢宗正海報","王漢宗細新宋簡體","王漢宗中明注音體","王漢宗波卡體空陰","王漢宗細明","王漢宗中明破音字1","王漢宗波浪體","王漢宗細黑","王漢宗中明破音字2","王漢宗海報體半天水","王漢宗中明破音字3","王漢宗中楷注音體","王漢宗超明","王漢宗中楷破音字1","王漢宗超黑俏皮動物","王漢宗中楷破音字2","王漢宗特黑","王漢宗酷儷海報","王漢宗中楷破音字3","王漢宗鋼筆行楷","王漢宗粗圓體雙空","王漢宗顏體"];
//-- var featurefonts = ["瀨戶字体", "衡山毛筆", "王漢宗粗鋼體", "王漢宗綜藝體", "王漢宗波浪體"];
-
  var fontlist = [
    ["Fontworks"],
    ["DotGothic16", "DotGothic16-Regular", "8231"],
    ["KleeOne / SemiBold", "KleeOne-SemiBold", "10178"],
    ["KleeOne", "KleeOne-Regular", "10178"],
    ["Stick", "Stick-Regular", "8231"],
    ["ReggaeOne", "ReggaeOne-Regular", "8231"],
    ["RampartOne", "RampartOne-Regular", "8231"],
    ["RocknRollOne", "RocknRollOne-Regular", "8230"],
    ["TrainOne", "TrainOne-Regular", "4356"],

    ["Google x Adobe"],
    ["思源宋體 / 極細", "NotoSerifCJKtc-ExtraLight", 65535],
    ["思源宋體 / 細", "NotoSerifCJKtc-Light", 65535],
    ["思源宋體", "NotoSerifCJKtc-Regular", 65535],
    ["思源宋體 / 適中", "NotoSerifCJKtc-Medium", 65535],
    ["思源宋體 / 次粗", "NotoSerifCJKtc-SemiBold", 65535],
    ["思源宋體 / 粗", "NotoSerifCJKtc-Bold", 65535],
    ["思源宋體 / 濃", "NotoSerifCJKtc-Black", 43029],

    ["思源黑體 / 極細", "NotoSansCJKtc-ExtraLight", 65535],
    ["思源黑體 / 細", "NotoSansCJKtc-Light", 65535],
    ["思源黑體", "NotoSansCJKtc-Regular", 65535],
    ["思源黑體 / 適中", "NotoSansCJKtc-Medium", 65535],
    ["思源黑體 / 次粗", "NotoSansCJKtc-SemiBold", 65535],
    ["思源黑體 / 粗", "NotoSansCJKtc-Bold", 65535],
    ["思源黑體 / 濃", "NotoSansCJKtc-Black", 65535],

    ["思源等寬", "NotoSansMonoCJKtc-Regular", 65535],
    ["思源等寬 / 粗", "NotoSansMonoCJKtc-Bold", 65535],

    ["cjkFonts x 清松手寫體"],
    ["cjk手寫4", "cjk手寫4", "12201"],

    ["justfont"],
    ["粉圓體", "openhuninn-1.1", "9676"],

    ["flopdesign"],
    ["裝甲明朝", "SoukouMincho", "9803"],

    ["翰字鑄造JT Foundry"],
    ["台北黑體 / 粗", "TaipeiSansTCBeta-Bold", "32732"],
    ["台北黑體", "TaipeiSansTCBeta-Regular", "32731"],
    ["台北黑體 / 細", "TaipeiSansTCBeta-Light", "32762"],

    ["GlyphWiki"],
    ["花園明朝A", "HanaminA", "41494"],
    ["花園明朝B", "HanaminB", "60418"],

    ["瀨戶家族 x Max"],
    ["內海字體 / 粗", "NaikaiFont-Bold", 46817],
    ["內海字體 / 次粗", "NaikaiFont-SemiBold", 46817],
    ["內海字體", "NaikaiFont-Regular", 46819],
    ["內海字體 / 細", "NaikaiFont-Light", 46817],
    ["內海字體 / 極細", "NaikaiFont-ExtraLight", 46817],
  ]
-
  var featurefonts = [
    ["內海字體", "NaikaiFont-Regular"],
    ["思源宋體", "NotoSerifCJKtc-Regular"],
    ["台北黑體", "TaipeiSansTCBeta-Regular"],
    ["cjk手寫4", "cjk手寫4"],
    ["粉圓體", "openhuninn-1.1"],
    ["Rampart", "RampartOne-Regular"]
  ]
html
  head
    meta(charset="utf-8")
    meta(property="og:locale",content="zh_TW")
    meta(property="og:image",content="http://plotdb.github.io/xfl/assets/img/thumbnail.png")
    meta(property="og:image:type",content="image/png")
    meta(property="og:image:width",content="1200")
    meta(property="og:image:height",content="630")
    meta(property="og:title",content="XL Font Load / 大尺寸字型載入器")
    meta(property="og:type",content="article")
    meta(property="og:url",content="http://plotdb.github.io/xfl/")
    meta(property="og:description",content="這個專案實作了一個快速中文字型載入模組，將字型檔依字頻切成小塊，再根據網頁內容選擇需要載入的字型子集")
    meta(property="article:author",content="zbryikt")
    meta(property="article:section",content="Taiwan")
    meta(name="keywords",content="webfont,font loader,cjk")
    +css("assets/lib/bootstrap/main/css/bootstrap.min.css")
    +css("assets/lib/bootstrap.ldui/main/bootstrap.ldui.min.css")
    +css("assets/lib/ldloader/main/ldld.min.css")
    +css("assets/lib/ldbutton/main/ldbtn.min.css")
    +css("assets/lib/@loadingio/loading.css/main/loading.min.css")
    +css("assets/lib/ldcover/main/ldcv.min.css")
    +css("css/index.css")
  body: #root
    .ldcv: .base(style="max-width:90%;width:640px;height:480px;max-height:90%"): .inner
      .w-100.h-100.d-flex.flex-column
        .flex-grow-1.position-relative.p-4
          .w-100.h-100.ld.ld-over-inverse
            .ld.ld-ring.ld-cycle
            svg.w-100.h-100.border.rounded.shadow-sm
              defs
                linearGradient#lg(x1="0",y1="0",x2="1",y2="1")
                  stop(offset="0%",stop-color="#f00")
                  stop(offset="25%",stop-color="#f90")
                  stop(offset="50%",stop-color="#9f0")
                  stop(offset="75%",stop-color="#0f9")
                  stop(offset="100%",stop-color="#09f")
              path(fill="url(#lg)")
        .d-flex.justify-content-end.px-4.pb-4: .btn.btn-outline-dark(data-ldcv-set="") Close

    h1
      span #[span.text-danger X]L #[span.text-danger F]ont #[span.text-danger L]oad / 
      ruby
        rb 大尺寸
        rt 中日韓
      span 字型載入器
    hr
    #chooser.d-flex
      .btn-group.mb-2.mr-2
        each font in featurefonts
          .btn.btn-outline-dark(data-font=font[1])= font[0]
      .dropdown(style="display:inline-block;vertical-align:top")
        .btn.btn-outline-dark.dropdown-toggle(data-toggle="dropdown") More
        .dropdown-menu.shadow-sm(style="max-height:400px;overflow:scroll;overscroll-behavior:contain")
          each font,$index in fontlist
            if font.length > 1
              a.dropdown-item.d-flex.align-items-center(href="#",data-font=font[1])
                .flex-grow-1= font[0]
                if font[2]
                  small.text-muted.ml-2 #{font[2]}字
            else
              if $index != 0
                .dropdown-divider
              .dropdown-header.text-underline= font[0]
          .dropdown-divider
          .dropdown-header 以下空白
          //-each font in enlist
            a.dropdown-item(href="#",data-font=font,data-type="en")= font
      .flex-grow-1.text-right
        .btn.btn-outline-dark(data-target="svg") 輸出 SVG

    textarea.form-control(rows="7",placeholder="在這邊隨便輸入一些中文字看看吧...")
    +nbr(2)
    h2 這是什麼？
    p 中文字型向來動輒數MB 甚至數十MB，若要做為網路字型使用往往很卡。其它解決方案大多是商業付費服務，而且針對動態內容，要嘛做不好，亦或成本很高。
    p 針對這個問題，#[span.text-danger X]L #[span.text-danger F]ont #[span.text-danger L]oad = #[code @plotdb/xfl] 實作了：
    ul
      li 中文字型切割工具
      li 中文字型載入模組
    p 先使用切割工具將字型依字頻切成小塊後，再使用載入器根據網頁內容選擇需要載入的字型子集，因此我們可以快速的選取想要的字型，套用在網站上。切割過後的字型亦可搭配 #[code opentype.js] 於前、後端進行字型組合。
    p 另一方面，此專案亦收集了下列等以 #[code SIL Open Font License 1.1] 釋出的免費、可商用開放中文字型，包含黑、宋、圓、手寫、風格等類型的字體，亦提供預先切割好的字型模組，可直接分支使用，不需再花時間自行搜集處理。
    p 以下為目前我們整理的字型列表，含不同樣式共 37 個字型檔：
    ul
      li 思源黑體 / 思源宋體 / 思源等寬 - 約六萬餘字
      li 花園明朝 - 約四萬 ~ 六萬字
      li 內海字體 ( 瀨戶、小瀨、全瀨整合版 ) - 約四萬餘字
      li 台北黑體 ( Beta 版 ) - 約三萬餘字
      li 裝甲明朝 ( 思源宋體之變體 ) - 約一萬五千字
      li cjk手寫4 ( 清松手寫4 的 AI 補完版 ) - 約一萬字
      li 粉圓體 ( justfont 基於 Kosugi Maru 的改良版 ) - 約一萬字
      li Fontworks 系列 ( 日文字型 ) - 約五千 ~ 一萬字
    br
    h3 我可以整理自己的中文字型集嗎？
    p 可以！此專案連同編譯程式碼一同釋出，可自動編譯切割指定之字型檔。
    br
    h2 我要怎麼取得跟使用？
    p 此專案託管於 #[a(href="https://github.com/plotdb/xfl") Github 專案庫] ，你可以造訪該網址並利用 Git 分支，或者直接下載整包模組。
    p 你亦可使用 #[code npm]：
    pre.code.
      npm install --save @plotdb/xfl
      npx xfl -o [out-dir] [font-dir] # 字型切割工具
    p 前端字型載入器則引入 #[code dist/xfl.js] 後使用：
    pre.code.
      &lt;script src="path-to/xfl.js"&gt;&lt;/script&gt;
      &lt;script&gt;
        xfl.load({path: "path-to/xl-font-folder"})
          .then(function(font) {
            font.sync("給定一些文字，xfl 就會幫你抓對應的字型檔");
          });
      &lt;/script&gt;
    p 詳細的文件請參照 #[a(href="https://github.com/plotdb/xfl/blob/master/README.md") Github 專案庫中的 README.md 文件]。

    br
    h3 與 justfont 或其它的網路字型服務比較？
    p 網路字型服務一般有兩個重點：
    ul
      li 自有字型
      li 網頁字型服務
    p 自有字型不用說，大部份字型服務提供者的商業核心還是在其高品質的自有字型，這是字型工具無法提供的。而在網頁字型服務這點，因為 #[code @plotdb/xfl] 套件缺乏動態後端組字機制，嚴格來說也無法取代動態生成式的網路字型服務。況且，一旦牽涉到後端組字，就算是自幹也會有主機跟流量的成本，因此除非有大量需求來攤平成本，否則使用這類服務的性價比一般還是會比自幹高。
    p 什麼時候會有大量需求的情境？比方說，若我們開發用戶可以自選字型的網頁編輯工具，用戶的每一個 keystroke 都可能導致一次 API Call ，但網頁字型服務往往就是以 API 呼叫次數做計費基準，我們又不太可能限制用戶打字的次數，這種情境下使用以次計價的服務就顯得不太實際。
    p 此外靜態字型子集較動態生成的字型檔來說在快取上較有優勢。若預期字型檔不會頻繁更新，可以設定較長的快取週期，並可搭配 Cloudflare 等 CDN 服務，可以獲得更快速的內容發送以及更少的流量負擔。
    br

    h3 換字型會閃 / 打字會閃 / 載入還是很久 / 字型有缺字
    p 以靜態方式實作網路字型仍然受限於瀏覽器技術，但若有任何問題，都可以在 #[a(href="https://github.com/plotdb/xfl/issues") Github Issues] 中提出。
    br
    hr
    #footer
      div source code copyrighted #[a(href="https://twitter.com/zbryikt") @zbryikt] released under MIT License
      div source in #[a(href="https://github.com/plotdb/xfl") Github Repo] / font files in #[a(href="https://github.com/plotdb/xl-fontset") Another Github Repo]

    +script("assets/lib/bootstrap.native/main/bootstrap-native-v4.min.js")
    +script("assets/lib/@loadingio/ldquery/main/ldq.min.js")
    +script("assets/lib/ldcover/main/ldcv.min.js")
    +script("assets/lib/ldloader/main/ldld.min.js")
    +script("assets/lib/proxise/main/proxise.min.js")
    +script("assets/lib/@plotdb/opentype.js/main/opentype.js")
    +script("assets/lib/@plotdb/xfl/dev/xfl.js")
    +script("js/index.js")
